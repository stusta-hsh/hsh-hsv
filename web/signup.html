<!DOCTYPE html>
<html>

<head>
	<link href="res/css/screen.css" rel="stylesheet" type="text/css" media="all">
	<link href="res/css/icons.css" rel="stylesheet" type="text/css" media="all">
	<script src="res/lib/jquery-3.5.1.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>HSH Signup</title>
</head>

<body>
	<div class='card'>
		<p class='title'>Sign up</p>
		
		<div class='split'>
			<div class='img'>
				<img src='res/icon.svg' alt='HSH Logo'>
			</div>

			<div class='form'>
				<div class='input'>
					<label for="name">Short Name*</label>
					<input type="text" id="name" required/>
				</div>
				<div class='input'>
					<label for="firstName">First Name</label>
					<input type="text" id="firstName"/>
				</div>
				<div class='input'>
					<label for="lastName">Last Name</label>
					<input type="text" id="lastName"/>
				</div>
				<div class='input'>
					<label for="room">
						<details>
							<summary>Room <i class='bi-question-circle'></i></summary>
							<p>Room number in the form <span class='reference'>House/Floor/Room</span>. The last slash is optional.</p>
							<p>If no house number is given, 9 (HSH) is assumed.</p>
							<p>In house 14, the WG number replaces the floor number.</p>
						</details>
					</label>
					<input type="room" id="room" pattern='^([0-9]{1,2}\/)?[0-9]{0,2}\/?[0-9]{1,2}$'/>
				</div>
				<div class='input'>
					<label for="email">Email*</label>
					<input type="email" id="email" required/>
				</div>
				<div class='input'>
					<label for="pwd">Password*</label>
					<input type="password" id="pwd" required/>
				</div>
				<input class='input' id='signupButton' type='button' value='Sign up'>
			</div>
		</div>
		
		<p>The fields marked with a * are required.</p>
	</div>

<script>

$("#room").change(function(e) {
	/*var regex = /^([0-9]{1,2}\/)?[0-9]{1,4}$/g;
	if ($("#room").val().match(regex) == null) {
		$("#room").setCustomValidity('not a room number');
	}*/
});

$("#signupButton").click(function() {
	$.ajax("api/user/request", {
		type: "POST",
		contentType: "application/json",
		data: JSON.stringify({
			name: $("#name").val(),
            firstName: $("#firstName").val(),
            lastName: $("#lastName").val(),
            email: $("#email").val(),
            password: $("#pwd").val()
		}),
		success: function() {
			window.location.href = "index";
		}
	});
})

</script>
</body>
</html>